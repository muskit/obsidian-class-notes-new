	DoAugust 31, Thursday

## Analysis process in the real world
1. **Collect sample**
2. Analyze sample
3. Assess impact
4. Report, signatures, Indicators of Compromise (IoC)
	- IoC ex: network activity, infections
5. **Mitigation, countermeasures**
The analyzer (person) likely just goes through steps 2-4.
## Levels of analysis
![[Day 2 2023-08-31 16.14.15.excalidraw]]
## Windows commands
`type` - print file contents to console
- unlike Linux, terminal is likely not to get messed up
`strings` - print ASCII strings to console

## Antivirus methods (intrusion detection systems)
### Signatures
- check running code with known signatures of malicious code
### Heuristics
- suspicious behavior

No matter the method, antiviruses are prone to false positives/negatives
## Virtual Machine risks
VM Detection
- can figure through inconsistencies/strange properties, such as installed drivers
Potential outcomes upon knowledge of VM presence
- malware may hide itself and avoid detection
- misuse existing facilities
	- shared clipboard, folders
	- time sync
	- network
	- MITIGATION: disable facilities before running
- exploit vulnerabilities in the VM software
	- VM escape
	- MITIGATION: keep VM software updated

## Format of Windows executables
PE (Portable Executable)
- metadata
- object code (the "written" code)
- static libraries
	- *static*: library code copied into .exe at development time
- dynamic library references (imports)
	- *dynamic*: library code that exists elsewhere
- data

analyzing a program in this state (unopened) is *static analysis*

## Running a program
a **loader** prepares some memory space for the opening executable
- establishes a virtual memory space
	- data
	- object code
	- libraries
	- heap & stack - may be determined from metadata
- sets up data structures for the kernel to manage
- results in a **process** running in memory

analyzing a program in this state (opened and running) is *dynamic analysis*

## Parts of a PE (as seen in PE-bear)
NT Headers
- useful non-code metadata of the executable
Sections
`.text` - object code
`.data` - heap, stack
- think undeclared variables
`.pdata` - persistent data
- think declared variables, literals